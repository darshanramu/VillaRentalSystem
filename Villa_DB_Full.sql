REMARK CREATEDB.SQL

CREATE TABLE MANAGER(
MANAGER_ID CHAR(4),
SUPERVISOR_ID CHAR(4) REFERENCES MANAGER(MANAGER_ID),
PRIMARY KEY(MANAGER_ID)
);

INSERT INTO MANAGER VALUES('U14',NULL);
INSERT INTO MANAGER VALUES('U15','U14');

REMARK ############################################################################

CREATE TABLE OWNER(
OWNER_ID CHAR(4),
PHONE VARCHAR2(12),
MANAGER_ID,
PRIMARY KEY(OWNER_ID),
FOREIGN KEY(MANAGER_ID) REFERENCES MANAGER(MANAGER_ID)
);

INSERT INTO OWNER VALUES('U11','111-111-1111','U15');
INSERT INTO OWNER VALUES('U12','222-222-2222','U15');
INSERT INTO OWNER VALUES('U13','333-333-3333','U15');
INSERT INTO OWNER VALUES('U14','444-444-4444',NULL);

REMARK ############################################################################

CREATE TABLE VILLA(
VILLA_ID CHAR(6),
VILLA_NAME VARCHAR2(10),
OWNER_ID CHAR(4),
PRIMARY KEY(VILLA_ID),
FOREIGN KEY(OWNER_ID) REFERENCES OWNER(OWNER_ID)
);

INSERT INTO VILLA VALUES('Vil1','Fifi','U11');
INSERT INTO VILLA VALUES('Vil2','Lulu','U12');
INSERT INTO VILLA VALUES('Vil3','Penny','U13');
INSERT INTO VILLA VALUES('Vil4','Kiki','U11');
INSERT INTO VILLA VALUES('Vil5','Vivi','U11');
INSERT INTO VILLA VALUES('Vil6','Gigi','U11');
INSERT INTO VILLA VALUES('Vil7','Kitty','U12');
INSERT INTO VILLA VALUES('Vil8','Ellie','U13');
INSERT INTO VILLA VALUES('Vil9','Ali','U14');
INSERT INTO VILLA VALUES('Vil10','Kelley','U12');
INSERT INTO VILLA VALUES('Vil11','Dori','U12');
INSERT INTO VILLA VALUES('Vil12','Houti','U13');

REMARK ############################################################################

CREATE TABLE FEATURES(
FEATURE_ID CHAR(6),
VILLA_ID CHAR(6) REFERENCES VILLA(VILLA_ID),
FEATURE_NAME VARCHAR2(20),
PRIMARY KEY(FEATURE_ID,VILLA_ID)
);

INSERT INTO FEATURES VALUES('Fea1','Vil1','swimming pool');
INSERT INTO FEATURES VALUES('Fea1','Vil2','swimming pool');
INSERT INTO FEATURES VALUES('Fea1','Vil3','swimming pool');
INSERT INTO FEATURES VALUES('Fea2','Vil1','Jacuzzi');
INSERT INTO FEATURES VALUES('Fea2','Vil4','Jacuzzi');
INSERT INTO FEATURES VALUES('Fea2','Vil11','Jacuzzi');
INSERT INTO FEATURES VALUES('Fea2','Vil12','Jacuzzi');
INSERT INTO FEATURES VALUES('Fea2','Vil6','Jacuzzi');
INSERT INTO FEATURES VALUES('Fea3','Vil7','billiard table');
INSERT INTO FEATURES VALUES('Fea4','Vil3','Xbox 360');
INSERT INTO FEATURES VALUES('Fea4','Vil5','Xbox 360');
INSERT INTO FEATURES VALUES('Fea4','Vil7','Xbox 360');
INSERT INTO FEATURES VALUES('Fea5','Vil3','board games');
INSERT INTO FEATURES VALUES('Fea5','Vil7','board games');
INSERT INTO FEATURES VALUES('Fea5','Vil9','board games');
INSERT INTO FEATURES VALUES('Fea5','Vil10','board games');
INSERT INTO FEATURES VALUES('Fea6','Vil6','pets allowed');
INSERT INTO FEATURES VALUES('Fea6','Vil7','pets allowed');
INSERT INTO FEATURES VALUES('Fea6','Vil8','pets allowed');

REMARK ############################################################################

CREATE TABLE REG_USER(
USER_ID CHAR(4),
EMAIL VARCHAR(25),
FNAME VARCHAR(10),
LNAME VARCHAR(10),
DOB DATE,
PRIMARY KEY(USER_ID)
);

INSERT INTO REG_USER VALUES('U1','jack_killer@gmail.com','Jackie','Jones',TO_DATE('28-02-83','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U2','Hello_macy@yahoo.com','Jessie','Jackson',TO_DATE('04-03-86','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U3','john_black@hotmail.com','Tommy','Trojan',TO_DATE('22-04-90','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U4','ny_robert@usc.edu','Niki','Nanjan',TO_DATE('10-06-80','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U5','cool_andrew@bbc.co.uk','Jalli','Shadan',TO_DATE('27-11-84','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U6','coryphillip@voa.gov','Houtan','Khandan',TO_DATE('06-06-66','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U7','DaneilJ@msnbc.co','Naz','Nazi',TO_DATE('20-04-00','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U8','rohanau@cs.mit.edu','Ab','Bazi',TO_DATE('12-12-56','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U9','edmorales@houti.com','Ben','Ghazi',TO_DATE('10-11-73','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U10','danamoon@louti.com','Carlos','Santana',TO_DATE('07-07-77','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U11','owner1@villa.com','Roberto','Carlos',TO_DATE('05-05-55','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U12','owner2@villa.com','De','Vilardo',TO_DATE('04-04-44','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U13','owner3@villa.com','villa','Blanka',TO_DATE('11-11-74','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U14','ceo@villa.com','nino','bino',TO_DATE('01-01-91','DD-MM-YY'));
INSERT INTO REG_USER VALUES('U15','manager2@villa.com','Bookish','Morinio',TO_DATE('17-04-50','DD-MM-YY'));

REMARK ############################################################################

CREATE TABLE FAVORITES(
USER_ID CHAR(4) REFERENCES REG_USER(USER_ID),
VILLA_ID CHAR(6) REFERENCES VILLA(VILLA_ID),
PRIMARY KEY(USER_ID,VILLA_ID)
);

INSERT INTO FAVORITES VALUES('U1','Vil2');
INSERT INTO FAVORITES VALUES('U1','Vil4');
INSERT INTO FAVORITES VALUES('U2','Vil8');
INSERT INTO FAVORITES VALUES('U3','Vil10');
INSERT INTO FAVORITES VALUES('U3','Vil3');
INSERT INTO FAVORITES VALUES('U3','Vil7');
INSERT INTO FAVORITES VALUES('U4','Vil10');
INSERT INTO FAVORITES VALUES('U4','Vil4');
INSERT INTO FAVORITES VALUES('U5','Vil1');
INSERT INTO FAVORITES VALUES('U6','Vil3');
INSERT INTO FAVORITES VALUES('U7','Vil2');
INSERT INTO FAVORITES VALUES('U7','Vil4');
INSERT INTO FAVORITES VALUES('U7','Vil12');
INSERT INTO FAVORITES VALUES('U8','Vil1');
INSERT INTO FAVORITES VALUES('U8','Vil9');
INSERT INTO FAVORITES VALUES('U9','Vil6');
INSERT INTO FAVORITES VALUES('U10','Vil11');
INSERT INTO FAVORITES VALUES('U10','Vil12');
INSERT INTO FAVORITES VALUES('U13','Vil1');
INSERT INTO FAVORITES VALUES('U14','Vil2');

REMARK ############################################################################

CREATE TABLE COUPON(
COUPON_ID CHAR(6),
VILLA_ID CHAR(6) REFERENCES VILLA(VILLA_ID),
START_DATE DATE,
END_DATE DATE,
DISCOUNT NUMBER(2),
PRIMARY KEY (COUPON_ID)
);

INSERT INTO COUPON VALUES('Coup1','Vil1',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-01-14','DD-MM-YY'),20);
INSERT INTO COUPON VALUES('Coup2','Vil2',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),15);
INSERT INTO COUPON VALUES('Coup3','Vil3',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),25);
INSERT INTO COUPON VALUES('Coup4','Vil4',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),10);
INSERT INTO COUPON VALUES('Coup5','Vil1',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),15);

REMARK ############################################################################

CREATE TABLE RESERVATION(
RES_ID CHAR(6),
USER_ID CHAR(4) REFERENCES REG_USER(USER_ID),
VILLA_ID CHAR(6) REFERENCES VILLA(VILLA_ID),
START_DATE DATE,
END_DATE DATE,
COUPON_ID CHAR(6) REFERENCES COUPON(COUPON_ID),
DEPOSIT NUMBER(4),
PRIMARY KEY(RES_ID)
);

INSERT INTO RESERVATION VALUES('Res1','U1','Vil1',TO_DATE('02-01-13','DD-MM-YY'),TO_DATE('04-01-13','DD-MM-YY'),NULL,50);
INSERT INTO RESERVATION VALUES('Res2','U7','Vil2',TO_DATE('05-01-13','DD-MM-YY'),TO_DATE('06-01-13','DD-MM-YY'),NULL,30);
INSERT INTO RESERVATION VALUES('Res3','U2','Vil3',TO_DATE('03-02-13','DD-MM-YY'),TO_DATE('07-02-13','DD-MM-YY'),NULL,60);
INSERT INTO RESERVATION VALUES('Res4','U4','Vil4',TO_DATE('04-02-13','DD-MM-YY'),TO_DATE('05-02-13','DD-MM-YY'),NULL,39);
INSERT INTO RESERVATION VALUES('Res5','U4','Vil5',TO_DATE('06-03-13','DD-MM-YY'),TO_DATE('12-03-13','DD-MM-YY'),NULL,40);
INSERT INTO RESERVATION VALUES('Res6','U4','Vil6',TO_DATE('23-04-13','DD-MM-YY'),TO_DATE('25-04-13','DD-MM-YY'),NULL,42);
INSERT INTO RESERVATION VALUES('Res7','U6','Vil7',TO_DATE('29-05-13','DD-MM-YY'),TO_DATE('01-06-13','DD-MM-YY'),NULL,60);
INSERT INTO RESERVATION VALUES('Res8','U10','Vil8',TO_DATE('30-07-13','DD-MM-YY'),TO_DATE('02-08-13','DD-MM-YY'),NULL,100);
INSERT INTO RESERVATION VALUES('Res9','U3','Vil9',TO_DATE('11-08-13','DD-MM-YY'),TO_DATE('12-08-13','DD-MM-YY'),NULL,24);
INSERT INTO RESERVATION VALUES('Res10','U2','Vil10',TO_DATE('19-08-13','DD-MM-YY'),TO_DATE('21-08-13','DD-MM-YY'),NULL,75);
INSERT INTO RESERVATION VALUES('Res11','U5','Vil11',TO_DATE('15-08-13','DD-MM-YY'),TO_DATE('17-08-13','DD-MM-YY'),NULL,51);
INSERT INTO RESERVATION VALUES('Res12','U6','Vil12',TO_DATE('27-08-13','DD-MM-YY'),TO_DATE('28-08-13','DD-MM-YY'),NULL,33);
INSERT INTO RESERVATION VALUES('Res13','U2','Vil1',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('03-09-13','DD-MM-YY'),NULL,40);
INSERT INTO RESERVATION VALUES('Res14','U5','Vil2',TO_DATE('02-09-13','DD-MM-YY'),TO_DATE('03-09-13','DD-MM-YY'),NULL,25);
INSERT INTO RESERVATION VALUES('Res15','U9','Vil3',TO_DATE('15-09-13','DD-MM-YY'),TO_DATE('20-09-13','DD-MM-YY'),'Coup3',36);
INSERT INTO RESERVATION VALUES('Res16','U5','Vil4',TO_DATE('01-10-13','DD-MM-YY'),TO_DATE('03-10-13','DD-MM-YY'),'Coup4',27);
INSERT INTO RESERVATION VALUES('Res17','U4','Vil5',TO_DATE('15-10-13','DD-MM-YY'),TO_DATE('16-10-13','DD-MM-YY'),NULL,24);
INSERT INTO RESERVATION VALUES('Res18','U5','Vil6',TO_DATE('02-11-13','DD-MM-YY'),TO_DATE('04-11-13','DD-MM-YY'),NULL,30);
INSERT INTO RESERVATION VALUES('Res19','U10','Vil7',TO_DATE('06-11-13','DD-MM-YY'),TO_DATE('07-11-13','DD-MM-YY'),NULL,50);
INSERT INTO RESERVATION VALUES('Res20','U9','Vil8',TO_DATE('06-11-13','DD-MM-YY'),TO_DATE('10-11-13','DD-MM-YY'),NULL,60);
INSERT INTO RESERVATION VALUES('Res21','U4','Vil9',TO_DATE('10-11-13','DD-MM-YY'),TO_DATE('13-11-13','DD-MM-YY'),NULL,15);
INSERT INTO RESERVATION VALUES('Res22','U4','Vil10',TO_DATE('11-11-13','DD-MM-YY'),TO_DATE('13-11-13','DD-MM-YY'),NULL,60);
INSERT INTO RESERVATION VALUES('Res23','U6','Vil11',TO_DATE('01-12-13','DD-MM-YY'),TO_DATE('04-12-13','DD-MM-YY'),NULL,40);
INSERT INTO RESERVATION VALUES('Res24','U5','Vil12',TO_DATE('23-12-13','DD-MM-YY'),TO_DATE('26-12-13','DD-MM-YY'),NULL,30);
INSERT INTO RESERVATION VALUES('Res25','U7','Vil1',TO_DATE('12-01-14','DD-MM-YY'),TO_DATE('15-01-14','DD-MM-YY'),'Coup1',48);
INSERT INTO RESERVATION VALUES('Res26','U9','Vil2',TO_DATE('06-01-14','DD-MM-YY'),TO_DATE('07-01-14','DD-MM-YY'),'Coup2',34);
INSERT INTO RESERVATION VALUES('Res27','U6','Vil2',TO_DATE('05-02-14','DD-MM-YY'),TO_DATE('09-02-14','DD-MM-YY'),NULL,40);
INSERT INTO RESERVATION VALUES('Res28','U5','Vil5',TO_DATE('09-02-14','DD-MM-YY'),TO_DATE('15-02-14','DD-MM-YY'),NULL,50);
INSERT INTO RESERVATION VALUES('Res29','U4','Vil8',TO_DATE('18-03-14','DD-MM-YY'),TO_DATE('19-03-14','DD-MM-YY'),NULL,120);
INSERT INTO RESERVATION VALUES('Res30','U2','Vil4',TO_DATE('27-04-14','DD-MM-YY'),TO_DATE('30-04-14','DD-MM-YY'),NULL,50);
INSERT INTO RESERVATION VALUES('Res31','U4','Vil10',TO_DATE('29-05-14','DD-MM-YY'),TO_DATE('01-06-14','DD-MM-YY'),NULL,96);
INSERT INTO RESERVATION VALUES('Res32','U9','Vil12',TO_DATE('28-07-14','DD-MM-YY'),TO_DATE('02-08-14','DD-MM-YY'),NULL,42);
INSERT INTO RESERVATION VALUES('Res33','U9','Vil7',TO_DATE('11-08-14','DD-MM-YY'),TO_DATE('12-08-14','DD-MM-YY'),NULL,75);
INSERT INTO RESERVATION VALUES('Res34','U7','Vil4',TO_DATE('15-08-14','DD-MM-YY'),TO_DATE('21-08-14','DD-MM-YY'),NULL,50);
INSERT INTO RESERVATION VALUES('Res35','U8','Vil8',TO_DATE('13-08-14','DD-MM-YY'),TO_DATE('17-08-14','DD-MM-YY'),NULL,120);
INSERT INTO RESERVATION VALUES('Res36','U3','Vil2',TO_DATE('27-08-14','DD-MM-YY'),TO_DATE('28-08-14','DD-MM-YY'),NULL,40);
INSERT INTO RESERVATION VALUES('Res37','U2','Vil11',TO_DATE('20-06-14','DD-MM-YY'),TO_DATE('23-06-14','DD-MM-YY'),NULL,70);
INSERT INTO RESERVATION VALUES('Res38','U1','Vil2',TO_DATE('28-08-14','DD-MM-YY'),TO_DATE('30-08-14','DD-MM-YY'),NULL,40);
INSERT INTO RESERVATION VALUES('Res39','U9','Vil1',TO_DATE('10-04-14','DD-MM-YY'),TO_DATE('15-04-14','DD-MM-YY'),NULL,60);
INSERT INTO RESERVATION VALUES('Res40','U9','Vil7',TO_DATE('05-02-14','DD-MM-YY'),TO_DATE('09-02-14','DD-MM-YY'),NULL,75);
INSERT INTO RESERVATION VALUES('Res41','U8','Vil7',TO_DATE('09-02-14','DD-MM-YY'),TO_DATE('15-02-14','DD-MM-YY'),NULL,75);
INSERT INTO RESERVATION VALUES('Res42','U5','Vil7',TO_DATE('18-03-14','DD-MM-YY'),TO_DATE('19-03-14','DD-MM-YY'),NULL,75);
INSERT INTO RESERVATION VALUES('Res43','U6','Vil1',TO_DATE('12-05-14','DD-MM-YY'),TO_DATE('13-05-14','DD-MM-YY'),'Coup5',51);

REMARK ############################################################################


CREATE TABLE RATE(
RATE_ID CHAR(6),
VILLA_ID CHAR(6) REFERENCES VILLA(VILLA_ID),
START_DATE DATE,
END_DATE DATE,
RATE NUMBER(4),
PRIMARY KEY(RATE_ID)
);

INSERT INTO RATE VALUES('Rat1','Vil1',TO_DATE('	01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),150);	
INSERT INTO RATE VALUES('Rat2','Vil2',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),100);	
INSERT INTO RATE VALUES('Rat3','Vil3',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),200);	
INSERT INTO RATE VALUES('Rat4','Vil4',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),130);	
INSERT INTO RATE VALUES('Rat5','Vil5',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),120);	
INSERT INTO RATE VALUES('Rat6','Vil6',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),140);	
INSERT INTO RATE VALUES('Rat7','Vil7',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),180);	
INSERT INTO RATE VALUES('Rat8','Vil8',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),300);	
INSERT INTO RATE VALUES('Rat9','Vil9',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),80);	
INSERT INTO RATE VALUES('Rat10','Vil10',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),250);	
INSERT INTO RATE VALUES('Rat11','Vil11',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),170);	
INSERT INTO RATE VALUES('Rat12','Vil12',TO_DATE('01-01-13','DD-MM-YY'),TO_DATE('31-08-13','DD-MM-YY'),110);	
INSERT INTO RATE VALUES('Rat13','Vil1',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),120);	
INSERT INTO RATE VALUES('Rat14','Vil2',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),75);	
INSERT INTO RATE VALUES('Rat15','Vil3',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),160);	
INSERT INTO RATE VALUES('Rat16','Vil4',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),90);	
INSERT INTO RATE VALUES('Rat17','Vil5',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),80);	
INSERT INTO RATE VALUES('Rat18','Vil6',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),100);	
INSERT INTO RATE VALUES('Rat19','Vil7',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),150);	
INSERT INTO RATE VALUES('Rat20','Vil8',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),200);	
INSERT INTO RATE VALUES('Rat21','Vil9',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),50);	
INSERT INTO RATE VALUES('Rat22','Vil10',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),200);	
INSERT INTO RATE VALUES('Rat23','Vil11',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),120);	
INSERT INTO RATE VALUES('Rat24','Vil12',TO_DATE('01-09-13','DD-MM-YY'),TO_DATE('31-12-13','DD-MM-YY'),90);	
INSERT INTO RATE VALUES('Rat25','Vil1',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),180);	
INSERT INTO RATE VALUES('Rat26','Vil2',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),120);	
INSERT INTO RATE VALUES('Rat27','Vil3',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),240);	
INSERT INTO RATE VALUES('Rat28','Vil4',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),150);	
INSERT INTO RATE VALUES('Rat29','Vil5',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),150);	
INSERT INTO RATE VALUES('Rat30','Vil6',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),180);	
INSERT INTO RATE VALUES('Rat31','Vil7',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),250);	
INSERT INTO RATE VALUES('Rat32','Vil8',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),400);	
INSERT INTO RATE VALUES('Rat33','Vil9',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),110);	
INSERT INTO RATE VALUES('Rat34','Vil10',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),320);	
INSERT INTO RATE VALUES('Rat35','Vil11',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),210);	
INSERT INTO RATE VALUES('Rat36','Vil12',TO_DATE('01-01-14','DD-MM-YY'),TO_DATE('31-08-14','DD-MM-YY'),140);	

REMARK ############################################################################

CREATE TABLE REVIEW(
REVIEW_ID CHAR(6),
USER_ID CHAR(4) REFERENCES REG_USER(USER_ID),
VILLA_ID CHAR(6) REFERENCES VILLA(VILLA_ID),
COMMENT_TEXT VARCHAR(60),
RATING NUMBER(1),
CONSTRAINT CHECK_RATING 
CHECK (RATING>0 AND RATING<6),
PRIMARY KEY(REVIEW_ID)
);

INSERT INTO REVIEW VALUES('Rev1','U1','Vil1','Poor maintainance considering the price.',2);
INSERT INTO REVIEW VALUES('Rev2','U2','Vil3','Boring and Dull',1);
INSERT INTO REVIEW VALUES('Rev3','U4','Vil6','Love it!',4);
INSERT INTO REVIEW VALUES('Rev4','U2','Vil1','Best vila error',2);
INSERT INTO REVIEW VALUES('Rev5','U7','Vil1','Though not clean, has fantastic scenery around it',3);
INSERT INTO REVIEW VALUES('Rev6','U5','Vil2','not recommended',1);
INSERT INTO REVIEW VALUES('Rev7','U6','Vil1','Good one',4);
INSERT INTO REVIEW VALUES('Rev8','U4','Vil4','I gonna rent again and again',5);
INSERT INTO REVIEW VALUES('Rev9','U9','Vil3','Good work',5);
INSERT INTO REVIEW VALUES('Rev10','U3','Vil9','A must visit villa',5);
INSERT INTO REVIEW VALUES('Rev11','U10','Vil8','Nice',1);
INSERT INTO REVIEW VALUES('Rev13','U6','Vil7','poor one',1);
INSERT INTO REVIEW VALUES('Rev14','U1','Vil7','popular one',4);
INSERT INTO REVIEW VALUES('Rev15','U7','Vil3','wanna go back!',5);

REMARK ############################################################################

CREATE TABLE LIKED_REVIEWS(
REVIEW_ID REFERENCES REVIEW(REVIEW_ID),
USER_ID REFERENCES REG_USER(USER_ID),
PRIMARY KEY(REVIEW_ID,USER_ID)
);

INSERT INTO LIKED_REVIEWS VALUES('Rev1','U4');
INSERT INTO LIKED_REVIEWS VALUES('Rev1','U2');
INSERT INTO LIKED_REVIEWS VALUES('Rev1','U3');
INSERT INTO LIKED_REVIEWS VALUES('Rev2','U7');
INSERT INTO LIKED_REVIEWS VALUES('Rev2','U4');
INSERT INTO LIKED_REVIEWS VALUES('Rev3','U8');
INSERT INTO LIKED_REVIEWS VALUES('Rev4','U9');
INSERT INTO LIKED_REVIEWS VALUES('Rev5','U2');
INSERT INTO LIKED_REVIEWS VALUES('Rev5','U4');
INSERT INTO LIKED_REVIEWS VALUES('Rev14','U2');
INSERT INTO LIKED_REVIEWS VALUES('Rev14','U4');
INSERT INTO LIKED_REVIEWS VALUES('Rev14','U6');
INSERT INTO LIKED_REVIEWS VALUES('Rev15','U3');
INSERT INTO LIKED_REVIEWS VALUES('Rev15','U6');
INSERT INTO LIKED_REVIEWS VALUES('Rev15','U7');

REMARK #############################ALL TABLES FOR VILLA DB CREATED###############################################

REMARK DROPDB.SQL

/* ADD DROP INDEX AS WELL WHEN YOU CREATE INDEXES */
DROP TABLE LIKED_REVIEWS;
DROP TABLE REVIEW;
DROP TABLE RATE;
DROP TABLE RESERVATION;
DROP TABLE COUPON;
DROP TABLE FAVORITES;
DROP TABLE REG_USER;
DROP TABLE FEATURES;
DROP TABLE VILLA;
DROP TABLE OWNER;
DROP TABLE MANAGER;

REMARK ############################################################################

/* QUERY 1. List all those villas that are equipped with Jacuzzi and follow a no-pet policy. */
SELECT VILLA_NAME, VILLA_ID
FROM VILLA
WHERE VILLA_ID IN ( SELECT VILLA_ID
                   FROM FEATURES
                   WHERE FEATURE_NAME='Jacuzzi' AND VILLA_ID NOT IN (SELECT VILLA_ID
								     FROM FEATURES
								     WHERE FEATURE_NAME='pets allowed'));

REMARK ############################################################################

/* QUERY 2. List the villa owner names, as well as the count of villas they own, sorted by count of villas. */

SELECT REG_USER.FNAME||' '||REG_USER.LNAME AS OWNER, COUNT(VILLA.OWNER_ID) AS NO_OF_VILLAS
FROM VILLA JOIN REG_USER ON VILLA.OWNER_ID=REG_USER.USER_ID
GROUP BY REG_USER.FNAME,REG_USER.LNAME
ORDER BY NO_OF_VILLAS;

REMARK ############################################################################

/* QUERY 3. Find the (first and last) name of all users who have ever used a coupon code offering a discount more than 10%. */
SELECT FNAME||' '||LNAME AS USER_NAME
FROM REG_USER
WHERE USER_ID IN ( SELECT USER_ID
		     FROM RESERVATION
                     WHERE COUPON_ID IN ( SELECT COUPON_ID
					    FROM COUPON
					    WHERE DISCOUNT>10));

REMARK ############################################################################

/* QUERY 4. Find the name of top three users who have had the highest amount of deposit during 2013.
Notes: Please note that a user (e.g., Jesse Jackson) might have two of the three highest-deposit reservations and this is totally fine./
SELECT * FROM (
SELECT FNAME||' '||LNAME AS USER_NAME, SUM(DEPOSIT) AS TOTAL_DEPOSIT
FROM RESERVATION R, REG_USER U
WHERE R.USER_ID=U.USER_ID
GROUP BY FNAME,LNAME
ORDER BY TOTAL_DEPOSIT DESC)
WHERE ROWNUM<=3;

REMARK ############################################################################

/* QUERY 5. Find the average age (in years) of users who rented villas during low-season last year 
(i.e. from September to December 2013).
Notes: Please note that a user who reserves a villa in late December 2013, and leaves the villa in Jan. 2014,
 is among the users that have rented the villa within the period of September to December. Also, note that we 
are interested in the average age (in years) at the time of reservation (start date). If a user is involved in
 two reservations, his age will be used in the calculations twice. */
		
SELECT AVG(MOD(TRUNC(100 - MONTHS_BETWEEN(DOB,SYSDATE)/12),100)) AS AVG_AGE_IN_YEARS
FROM REG_USER U,RESERVATION R
WHERE U.USER_ID=R.USER_ID AND R.START_DATE BETWEEN TO_DATE('01-09-13','DD-MM-YY') AND TO_DATE('31-12-13','DD-MM-YY');

REMARK ############################################################################

/* QUERY 6. Find the three villas and their associated owners, who have the highest average user rating. */
SELECT * 
FROM 	(
	SELECT R.VILLA_ID AS VID,V.VILLA_NAME,U.FNAME||' '||U.LNAME AS OWNER, AVG(RATING)
	FROM REVIEW R,VILLA V,REG_USER U
	WHERE R.VILLA_ID=V.VILLA_ID AND U.USER_ID=V.OWNER_ID
	GROUP BY R.VILLA_ID,V.VILLA_NAME,U.FNAME,U.LNAME
	ORDER BY AVG(RATING) DESC
	)
WHERE ROWNUM<=3;

REMARK ############################################################################

/* QUERY 7. Find the villa with the highest count of reserved nights in 2014. */

SELECT *
FROM	(
	SELECT R.VILLA_ID AS VID,V.VILLA_NAME,COUNT(R.VILLA_ID) AS NO_OF_RESERVATIONS
	FROM RESERVATION R, VILLA V
	WHERE  EXTRACT (YEAR FROM TO_DATE(START_DATE,'DD-MM-YYYY')) = 14 AND R.VILLA_ID=V.VILLA_ID
	GROUP BY R.VILLA_ID,V.VILLA_NAME
	ORDER BY COUNT(R.VILLA_ID) DESC
	)
WHERE ROWNUM<=1;


/* QUERY 8. Find the most famous reviewer: the user who owns reviews that have been liked the most for 
a larger number of villas compared to any other reviewer. Please note that we are NOT looking
 for the user who has received the largest total number of likes. Rather, we care about the count
 of villas in which a user's reviews were considered as the top review. */


SELECT FNAME||' '||LNAME AS TOP_REVIEWER
FROM REG_USER
WHERE USER_ID=(
		SELECT RID
		FROM 	( 
			SELECT R.USER_ID AS RID
			FROM REVIEW R, LIKED_REVIEWS L
			WHERE R.REVIEW_ID=L.REVIEW_ID
			GROUP BY R.USER_ID
			ORDER BY COUNT(DISTINCT R.VILLA_ID) DESC,COUNT(L.REVIEW_ID) DESC
			)WHERE ROWNUM<=1
		);


